# 变更提案: GitHub Release 版本监控（多仓库）

## 需求背景
需要一个支持“手动触发 + 定时执行”的 GitHub Actions 工作流，用于监控多个 GitHub 仓库是否发布了新的 Release 版本，并将结果汇总到一个固定 Issue 中；同时将“上次已知版本”状态存储在该 Issue 的 body 里，避免重复提醒。

## 产品分析

### 目标用户与场景
- **用户群体:** 仓库维护者、依赖上游版本更新的使用者
- **使用场景:** 每日定时检查上游是否发布新版本；遇到紧急情况可手动触发立即检查
- **核心痛点:** 多仓库人工检查成本高、容易漏掉；需要一个集中入口追踪更新

### 价值主张与成功指标
- **价值主张:** 通过一个工作流与一个固定 Issue，集中展示多仓库 Release 状态并自动去重提醒
- **成功指标:**
  - 每日北京时间 02:00 自动执行检查
  - 手动触发可立即检查
  - 检测到新 Release 时更新固定 Issue，并更新状态以避免重复提醒

### 人文关怀
默认最小权限；不在仓库中存放任何明文密钥；监控配置使用环境变量/仓库变量，便于维护与审计。

## 变更内容
1. 新增版本监控工作流：支持 `workflow_dispatch` + `schedule`
2. 支持监控多个仓库：通过环境变量 `RELEASE_WATCH_REPOS` 配置（逗号/换行分隔的 `owner/repo`）
3. 使用固定 Issue（标题：`版本更新监控`）集中展示结果，并在其 body 存储状态（JSON 区块）
4. 更新 README：补充工作流用法与配置说明

## 影响范围
- **模块:** workflows、docs
- **文件:** `.github/workflows/*`、`README.md`
- **API:** 无
- **数据:** Issue body（状态 JSON）

## 核心场景

### 需求: 多仓库 Release 检查
**模块:** workflows
可配置多个仓库并检查其最新 Release。

#### 场景: 通过环境变量配置监控列表
从环境变量中读取多个 `owner/repo` 并逐个检查。
- 支持逗号/换行分隔
- 自动去重与忽略空项

### 需求: 定时 + 手动触发
**模块:** workflows
支持每天定时运行与手动运行。

#### 场景: 北京时间每日 02:00 定时运行
GitHub cron 使用 UTC 表达，需换算并在文档中说明。
- 每日 02:00（UTC+8）运行
- 具备并发控制避免重叠执行

### 需求: 固定 Issue 汇总与状态存储
**模块:** workflows
将监控结果写入固定 Issue，并在 body 内保存上次状态，避免重复提醒。

#### 场景: 检测到新版本只提醒一次
当某仓库出现新 Release（tag 不同于上次记录）时，在 Issue 中体现为“更新”，并同步写回状态。
- 状态存储在 Issue body 的 JSON 区块
- Issue 标题固定，避免产生大量 Issue

## 风险评估
- **风险:** Issue body 状态被手动编辑导致解析失败
- **缓解:** 使用明确标记区块；解析失败时自动重建状态并在 Issue 中提示

